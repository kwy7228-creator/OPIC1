<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Story-based Spoken English (Day 1–3)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 16px;
    }
    .app {
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 10px;
      padding: 16px 18px 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    }
    h1 { text-align: center; margin-top: 0; }
    select, button, textarea {
      font: inherit;
    }
    .top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    .tabs button {
      margin-right: 6px;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #fafafa;
      cursor: pointer;
    }
    .tabs button.active {
      background: #2563eb;
      color: white;
      border-color: #2563eb;
    }
    .card {
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      padding: 12px;
      margin-top: 10px;
      background: #fafafa;
    }
    .hidden { display: none; }
    .phrase { font-size: 20px; font-weight: 700; }
    .muted { color: #666; font-size: 14px; }
    .options div {
      border: 1px solid #ddd;
      padding: 8px;
      border-radius: 6px;
      margin-top: 6px;
      cursor: pointer;
    }
    .options div:hover { background: #eef2ff; }
    textarea {
      width: 100%;
      min-height: 80px;
      margin-top: 6px;
      padding: 8px;
      box-sizing: border-box;
    }
    .story {
      white-space: pre-wrap;
      line-height: 1.6;
      margin-top: 10px;
    }
  </style>
</head>

<body>
<div class="app">
  <h1>Story-based Spoken English (Day 1–3)</h1>

  <div class="top">
    <div>
      Day:
      <select id="daySelect"></select>
    </div>
    <div class="tabs">
      <button onclick="showTab('learn')" class="active">1) Expressions</button>
      <button onclick="showTab('situ')">2) Situations</button>
      <button onclick="showTab('story')">3) Story</button>
      <button onclick="showTab('qa')">4) Q&A</button>
    </div>
  </div>

  <!-- EXPRESSIONS -->
  <div id="learn" class="card">
    <div id="exprBox"></div>
    <button onclick="nextExpr()">Next Expression</button>
    <button onclick="speak(currentExpr.example)">▶ Example</button>
  </div>

  <!-- SITUATIONS -->
  <div id="situ" class="card hidden">
    <div id="situBox"></div>
  </div>

  <!-- STORY -->
  <div id="story" class="card hidden">
    <button onclick="playStory()">▶ Play Story (Audio)</button>
    <div class="story" id="storyText"></div>
  </div>

  <!-- Q&A -->
  <div id="qa" class="card hidden">
    <div id="qaBox"></div>
  </div>
</div>

<script>
/* ================= DATA ================= */
const DAYS = [
  {
    day: 1,
    expressions: [
      { phrase:"I'm down.", meaning:"나 콜 / 좋아", example:"A: Wanna grab dinner? B: I'm down." },
      { phrase:"I'm not sure.", meaning:"잘 모르겠어 / 애매해", example:"I'm not sure if I can make it tonight." },
      { phrase:"That makes sense.", meaning:"말 되네", example:"Yeah, that makes sense." },
      { phrase:"No worries.", meaning:"괜찮아", example:"Sorry I'm late. – No worries." },
      { phrase:"I'm running late.", meaning:"나 늦고 있어", example:"I'm running late. I'll be there soon." }
    ],
    situations: [
      { q:"저녁 제안에 흔쾌히 동의하고 싶다.", options:["I'm down.","I agree you.","I like it."], answer:"I'm down." },
      { q:"아직 확답을 못 하겠다.", options:["I'm not sure.","I don't know clear.","I will see."], answer:"I'm not sure." }
    ],
    story: `I was supposed to meet my friend after work, but I was running late.
Traffic was terrible, and I wasn’t sure if I could make it.
When I arrived, my friend smiled and said, “No worries.”
We talked about dinner, and I said, “I’m down.”
The place he suggested was close, and that really made sense.`,
    questions: [
      "Why was the speaker late?",
      "How did the friend react?",
      "What would you do in this situation?"
    ]
  },
  {
    day: 2,
    expressions: [
      { phrase:"I'm good.", meaning:"난 됐어 / 사양", example:"No thanks, I'm good." },
      { phrase:"I can't make it.", meaning:"못 가", example:"Sorry, I can't make it tonight." },
      { phrase:"It depends.", meaning:"케바케", example:"Is it hard? It depends." },
      { phrase:"I'll let you know.", meaning:"나중에 알려줄게", example:"I'll let you know after I decide." },
      { phrase:"Honestly, ...", meaning:"솔직히 말해서", example:"Honestly, I'm tired today." }
    ],
    situations: [
      { q:"음식을 더 권할 때 정중히 사양", options:["I'm good.","I refuse.","I don't eat."], answer:"I'm good." },
      { q:"모임 참석이 어렵다", options:["I can't make it.","I impossible.","I will not go."], answer:"I can't make it." }
    ],
    story: `My friend invited me to a big party this weekend.
Honestly, I was exhausted and didn’t feel like going.
I told him I couldn’t make it.
He asked if I might join next time, and I said, “It depends.”
I wasn’t sure yet, so I added, “I’ll let you know.”`,
    questions: [
      "Why didn’t the speaker go to the party?",
      "What does “It depends” mean here?",
      "How would you reply in a similar situation?"
    ]
  },
  {
    day: 3,
    expressions: [
      { phrase:"I'm tied up.", meaning:"너무 바빠", example:"I'm tied up right now." },
      { phrase:"Can we reschedule?", meaning:"일정 다시 잡자", example:"Can we reschedule for tomorrow?" },
      { phrase:"I'll get back to you.", meaning:"확인 후 연락", example:"I'll get back to you soon." },
      { phrase:"That works for me.", meaning:"난 괜찮아", example:"3 p.m.? That works for me." },
      { phrase:"I'm almost done.", meaning:"거의 끝났어", example:"Give me five minutes, I'm almost done." }
    ],
    situations: [
      { q:"지금 너무 바쁘다", options:["I'm tied up.","I'm busy brain.","I'm working head."], answer:"I'm tied up." },
      { q:"미팅 시간 변경 요청", options:["Can we reschedule?","Change schedule.","Move meeting."], answer:"Can we reschedule?" }
    ],
    story: `My coworker messaged me in the morning, but I was tied up with work.
He asked if we could meet at two, so I suggested, “Can we reschedule?”
Later, he proposed three o’clock, and I said, “That works for me.”
I still needed to check one thing, so I told him I’d get back to him.
After lunch, I was almost done and finally sent my reply.`,
    questions: [
      "Why couldn’t the speaker meet at first?",
      "How was the meeting time decided?",
      "How would you handle a busy workday like this?"
    ]
  }
];

/* ================= LOGIC ================= */
let currentDay = DAYS[0];
let exprIndex = 0;
let currentExpr = currentDay.expressions[0];

function initDays() {
  const sel = document.getElementById("daySelect");
  DAYS.forEach((d, i) => {
    const o = document.createElement("option");
    o.value = i;
    o.textContent = "Day " + d.day;
    sel.appendChild(o);
  });
  sel.onchange = () => {
    currentDay = DAYS[sel.value];
    exprIndex = 0;
    currentExpr = currentDay.expressions[0];
    renderAll();
  };
}

function showTab(tab) {
  document.querySelectorAll(".card").forEach(c => c.classList.add("hidden"));
  document.getElementById(tab).classList.remove("hidden");
  document.querySelectorAll(".tabs button").forEach(b => b.classList.remove("active"));
  event.target.classList.add("active");
}

function renderExpr() {
  currentExpr = currentDay.expressions[exprIndex];
  document.getElementById("exprBox").innerHTML = `
    <div class="phrase">${currentExpr.phrase}</div>
    <div class="muted">${currentExpr.meaning}</div>
    <div class="muted">${currentExpr.example}</div>
  `;
}

function nextExpr() {
  exprIndex = (exprIndex + 1) % currentDay.expressions.length;
  renderExpr();
}

function renderSitu() {
  document.getElementById("situBox").innerHTML =
    currentDay.situations.map(s => `
      <div class="muted">${s.q}</div>
      <div class="options">
        ${s.options.map(o =>
          `<div onclick="alert('${o === s.answer ? "정답!" : "오답"}')">${o}</div>`
        ).join("")}
      </div>
      <hr>
    `).join("");
}

function playStory() {
  speak(currentDay.story);
  document.getElementById("storyText").textContent = currentDay.story;
}

function renderQA() {
  document.getElementById("qaBox").innerHTML =
    currentDay.questions.map(q => `
      <div class="muted">${q}</div>
      <textarea placeholder="Answer in English..."></textarea>
      <hr>
    `).join("");
}

function speak(text) {
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "en-US";
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

function renderAll() {
  renderExpr();
  renderSitu();
  renderQA();
  document.getElementById("storyText").textContent = "";
}

initDays();
renderAll();
</script>
</body>
</html>
